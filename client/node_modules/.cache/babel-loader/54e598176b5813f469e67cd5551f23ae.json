{"ast":null,"code":"import { ToneAudioNode } from \"../../core/context/ToneAudioNode\";\nimport { optionsFromArguments } from \"../../core/util/Defaults\";\nimport { Param } from \"../../core/context/Param\";\nimport { assert } from \"../../core/util/Debug\";\n/**\n * Thin wrapper around the native Web Audio [BiquadFilterNode](https://webaudio.github.io/web-audio-api/#biquadfilternode).\n * BiquadFilter is similar to [[Filter]] but doesn't have the option to set the \"rolloff\" value.\n * @category Component\n */\n\nexport class BiquadFilter extends ToneAudioNode {\n  constructor() {\n    super(optionsFromArguments(BiquadFilter.getDefaults(), arguments, [\"frequency\", \"type\"]));\n    this.name = \"BiquadFilter\";\n    const options = optionsFromArguments(BiquadFilter.getDefaults(), arguments, [\"frequency\", \"type\"]);\n    this._filter = this.context.createBiquadFilter();\n    this.input = this.output = this._filter;\n    this.Q = new Param({\n      context: this.context,\n      units: \"number\",\n      value: options.Q,\n      param: this._filter.Q\n    });\n    this.frequency = new Param({\n      context: this.context,\n      units: \"frequency\",\n      value: options.frequency,\n      param: this._filter.frequency\n    });\n    this.detune = new Param({\n      context: this.context,\n      units: \"cents\",\n      value: options.detune,\n      param: this._filter.detune\n    });\n    this.gain = new Param({\n      context: this.context,\n      units: \"gain\",\n      value: options.gain,\n      param: this._filter.gain\n    });\n    this.type = options.type;\n  }\n\n  static getDefaults() {\n    return Object.assign(ToneAudioNode.getDefaults(), {\n      Q: 1,\n      type: \"lowpass\",\n      frequency: 350,\n      detune: 0,\n      gain: 0\n    });\n  }\n  /**\n   * The type of this BiquadFilterNode. For a complete list of types and their attributes, see the\n   * [Web Audio API](https://webaudio.github.io/web-audio-api/#dom-biquadfiltertype-lowpass)\n   */\n\n\n  get type() {\n    return this._filter.type;\n  }\n\n  set type(type) {\n    const types = [\"lowpass\", \"highpass\", \"bandpass\", \"lowshelf\", \"highshelf\", \"notch\", \"allpass\", \"peaking\"];\n    assert(types.indexOf(type) !== -1, `Invalid filter type: ${type}`);\n    this._filter.type = type;\n  }\n  /**\n   * Get the frequency response curve. This curve represents how the filter\n   * responses to frequencies between 20hz-20khz.\n   * @param  len The number of values to return\n   * @return The frequency response curve between 20-20kHz\n   */\n\n\n  getFrequencyResponse(len = 128) {\n    // start with all 1s\n    const freqValues = new Float32Array(len);\n\n    for (let i = 0; i < len; i++) {\n      const norm = Math.pow(i / len, 2);\n      const freq = norm * (20000 - 20) + 20;\n      freqValues[i] = freq;\n    }\n\n    const magValues = new Float32Array(len);\n    const phaseValues = new Float32Array(len); // clone the filter to remove any connections which may be changing the value\n\n    const filterClone = this.context.createBiquadFilter();\n    filterClone.type = this.type;\n    filterClone.Q.value = this.Q.value;\n    filterClone.frequency.value = this.frequency.value;\n    filterClone.gain.value = this.gain.value;\n    filterClone.getFrequencyResponse(freqValues, magValues, phaseValues);\n    return magValues;\n  }\n\n  dispose() {\n    super.dispose();\n\n    this._filter.disconnect();\n\n    this.Q.dispose();\n    this.frequency.dispose();\n    this.gain.dispose();\n    this.detune.dispose();\n    return this;\n  }\n\n}","map":{"version":3,"sources":["../../../../Tone/component/filter/BiquadFilter.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { ToneAudioNode } from \"../../core/context/ToneAudioNode\";\nimport { optionsFromArguments } from \"../../core/util/Defaults\";\nimport { Param } from \"../../core/context/Param\";\nimport { assert } from \"../../core/util/Debug\";\n/**\n * Thin wrapper around the native Web Audio [BiquadFilterNode](https://webaudio.github.io/web-audio-api/#biquadfilternode).\n * BiquadFilter is similar to [[Filter]] but doesn't have the option to set the \"rolloff\" value.\n * @category Component\n */\nexport class BiquadFilter extends ToneAudioNode {\n    constructor() {\n        super(optionsFromArguments(BiquadFilter.getDefaults(), arguments, [\"frequency\", \"type\"]));\n        this.name = \"BiquadFilter\";\n        const options = optionsFromArguments(BiquadFilter.getDefaults(), arguments, [\"frequency\", \"type\"]);\n        this._filter = this.context.createBiquadFilter();\n        this.input = this.output = this._filter;\n        this.Q = new Param({\n            context: this.context,\n            units: \"number\",\n            value: options.Q,\n            param: this._filter.Q,\n        });\n        this.frequency = new Param({\n            context: this.context,\n            units: \"frequency\",\n            value: options.frequency,\n            param: this._filter.frequency,\n        });\n        this.detune = new Param({\n            context: this.context,\n            units: \"cents\",\n            value: options.detune,\n            param: this._filter.detune,\n        });\n        this.gain = new Param({\n            context: this.context,\n            units: \"gain\",\n            value: options.gain,\n            param: this._filter.gain,\n        });\n        this.type = options.type;\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            Q: 1,\n            type: \"lowpass\",\n            frequency: 350,\n            detune: 0,\n            gain: 0,\n        });\n    }\n    /**\n     * The type of this BiquadFilterNode. For a complete list of types and their attributes, see the\n     * [Web Audio API](https://webaudio.github.io/web-audio-api/#dom-biquadfiltertype-lowpass)\n     */\n    get type() {\n        return this._filter.type;\n    }\n    set type(type) {\n        const types = [\"lowpass\", \"highpass\", \"bandpass\",\n            \"lowshelf\", \"highshelf\", \"notch\", \"allpass\", \"peaking\"];\n        assert(types.indexOf(type) !== -1, `Invalid filter type: ${type}`);\n        this._filter.type = type;\n    }\n    /**\n     * Get the frequency response curve. This curve represents how the filter\n     * responses to frequencies between 20hz-20khz.\n     * @param  len The number of values to return\n     * @return The frequency response curve between 20-20kHz\n     */\n    getFrequencyResponse(len = 128) {\n        // start with all 1s\n        const freqValues = new Float32Array(len);\n        for (let i = 0; i < len; i++) {\n            const norm = Math.pow(i / len, 2);\n            const freq = norm * (20000 - 20) + 20;\n            freqValues[i] = freq;\n        }\n        const magValues = new Float32Array(len);\n        const phaseValues = new Float32Array(len);\n        // clone the filter to remove any connections which may be changing the value\n        const filterClone = this.context.createBiquadFilter();\n        filterClone.type = this.type;\n        filterClone.Q.value = this.Q.value;\n        filterClone.frequency.value = this.frequency.value;\n        filterClone.gain.value = this.gain.value;\n        filterClone.getFrequencyResponse(freqValues, magValues, phaseValues);\n        return magValues;\n    }\n    dispose() {\n        super.dispose();\n        this._filter.disconnect();\n        this.Q.dispose();\n        this.frequency.dispose();\n        this.gain.dispose();\n        this.detune.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=BiquadFilter.js.map"]},"metadata":{},"sourceType":"module"}